<html>
  <head>
    <link href="css/simple.css" rel="stylesheet" type="text/css" media="all">
    <script src='js/jquery.js'></script>

    <!-- TODO: 3 -->
    <!--  Spinners for Ajax loading -->

    <script src='js/ajax_globals.js'></script>

    <!-- TODO: -->
    <!-- Ajax Global Handlers -->

    <script>
      // Fires when DOM is loaded.
      $(document).ready(function(){
        <!-- TODO: 1 -->
        // Retrieve all the articles
        // And update the article list in the DOM.

        $('#new-article').submit(function(event){

          var $form = $(event.target),
          $title = $form.find('input[name="title"]'),
          $body = $form.find('input[name="body"]'),
          url = $form.attr('action');

          event.preventDefault();
          //Ajax post
           $.ajax({
              url: url,
              type: 'POST',
              data: {article:{title: $title.val(), body: $body.val()}},
              dataType: 'json',
              success: function(response){
                var article = response.article,

                articleHTML = '<li id=article_' + article.id + '>';
                articleHTML += "Title: " + article.title;
                articleHTML += '<div>' + "Body: " + article.body + '</div>';
                articleHTML += '</li>';

                $('#articles').append(articleHTML);
              }
            });//end of post
          });//end of submit




        //.get is a shortcut for .ajax
        $.get('http://localhost:3000', function(data){
          var articles = data.articles,
          articlesHTML = '';
          event.preventDefault();
        for(var i = 0; i < articles.length; i = i + 1){
          articlesHTML += '<li id=article_' + articles[i].id + '>' + "Title: " + articles[i].title;
          articlesHTML += '<div>' + "Body: " + articles[i].body + '</div>';
          articlesHTML += '</li>';
        };

        $('#articles').append(articlesHTML);

        });

      }); // end ready
    </script>
  </head>
  <body>
    <!-- TODO: 2 -->
    <!-- Ajax Loading Spinner-->
    <div id="ajaxSpinnerContainer" class='centered'>
      <img src="images/ajax-loader.gif" id="ajaxSpinnerImage" title="working...">
    </div>


    <h3>Simple Ajax Get</h3>

    <div id='container'>
    <!-- form to create a new article -->
      <form id='new-article' action="http://localhost:3000/articles">
        <input type="text" name="title" placeholder="Enter a new title">
        <input type="textarea" name="body" placeholder="Enter new contents">
        <input type="submit" value="Create Article">
      </form>

      <!-- List of all the Articles -->
      <ul id='articles'>Articles
      </ul>



    </div>

  </body>
</html>
